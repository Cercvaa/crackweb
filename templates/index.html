{% extends "base.html" %}
{% block content %}
<div class="card shadow-sm">
  <div class="card-body">
    {% if error %}
      <div class="alert alert-danger">{{ error }}</div>
    {% endif %}

    <form action="/predict" method="post" enctype="multipart/form-data" class="needs-validation" novalidate>
      <div class="mb-3">
        <label for="file" class="form-label fw-medium">Choose a concrete surface photo</label>
        <input
          class="form-control"
          type="file"
          id="file"
          name="file"
          accept="image/*"
          capture="environment"   <!-- enables camera on mobile -->
          required
        >
        <div class="form-text">You can take a photo on mobile or upload an existing image.</div>
        <div class="invalid-feedback">Please select an image.</div>
      </div>
      <button class="btn btn-primary" type="submit">
        Analyze Image
      </button>
    </form>
  </div>
</div>

<script>
  // simple client-side validation
  (() => {
    'use strict'
    const forms = document.querySelectorAll('.needs-validation')
    Array.from(forms).forEach(form => {
      form.addEventListener('submit', event => {
        if (!form.checkValidity()) {
          event.preventDefault()
          event.stopPropagation()
        }
        form.classList.add('was-validated')
      }, false)
    })
  })()
</script>
{% endblock %}
